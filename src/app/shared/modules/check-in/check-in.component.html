<h1 class="mat-dialog-title" *ngIf="search_obj">Check-in
    <button #queue mat-dialog-close class="modal_close">
        <i class="fa fa-window-close" aria-hidden="true"></i>
    </button>
  </h1>
  <mat-dialog-content *ngIf="search_obj">
      
        <div class="mainouter">
          <div class="main-head">
            Check-in at <span class='prov_name'>{{search_obj.fields.title}}</span>, <span class="loc_name">{{search_obj.fields.place1}}</span>
          </div>
          <div class="date-outer" *ngIf="step==1">
           <span class="selected-date"> Date: {{sel_checkindate | date: dateFormat}}</span> <span class="future-text" (click)="handleFuturetoggle()" *ngIf="futuredate_allowed">Do you want to Check in for a Different Date / Time ?</span>
          </div>
          <div class="date-outer" *ngIf="step==2">
            <span class="selected-date"> Date: {{sel_checkindate | date: dateFormat}}</span> 
           </div>
          <div class="future-date-outer" *ngIf="showfuturediv">
                <div class="form-group">
                    <label for="reason" class="col-form-label">Select the required date</label>
                    <div class="pickerouter">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker (selectedChanged)="handleFutureDateChange($event)"></mat-datepicker> 
                        <input class="form-control" type="text" matInput [matDatepicker]="picker" [min]="minDate" [max]="maxDate">
                    </div>
                </div>
            </div>
          <div class="service-outer">
          <div class="service-head" *ngIf="step==1">For Service</div>
          
          <ng-container *ngIf="step==1">
          <mat-chip-list *ngIf="servicesjson.length > 0">
            <mat-chip *ngFor="let serv of servicesjson" (click)="handleServiceSel(serv)" [selected] ="isSelectedService(serv.id)">{{serv.name}}</mat-chip>
          </mat-chip-list>
          </ng-container>

          <ng-container *ngIf="step==2">
            <span class="selected-ser-nam-caption">Service: </span><span class="selected-ser-name">{{sel_ser_det.name}}</span>
          </ng-container>

          <div class="service-details" *ngIf="sel_ser && sel_ser_det?.duration">
              <div class="service-duration">Duration: {{sel_ser_det.duration}} Minutes</div>
              <div class="service-price">Price: {{sel_ser_det.price}} <span class='taxable' *ngIf="sel_ser_det.taxable"> (Plus Tax)</span></div>
              <div class="service-desc" *ngIf="sel_ser_det.description != '' && sel_ser_det.description != undefined">Description: {{sel_ser_det.description}}</div>
          </div>
          </div>
          <div class="queue-outer">
                <div class="queue-head" *ngIf="step==1">Queue </div>
                
                <ng-container *ngIf="queuejson.length > 0 && step==1">
                <mat-chip-list>
                <mat-chip *ngFor="let que of queuejson" (click)="handleQueueSel(que)" [selected] ="isSelectedQueue(que.id)">{{que.name}}</mat-chip>
                </mat-chip-list>

                <ng-container *ngIf="step==2">
                    <span class="selected-ser-nam-caption">Queue: </span><span class="selected-ser-name">{{sel_queue_name}}</span>
                  </ng-container>

                <div class="queue-waitingdiv">
                    <div class="queue-head">Estimated Waiting Time: <span clas="queue-avail-date">{{sel_queue_waitingmins}} Mins</span></div>
                </div>
                </ng-container>
                <ng-container *ngIf="queuejson.length == 0">
                    <span class='no-queue-available'>No Queues available for the date.</span>
                </ng-container>
          </div>

          <div class="servicefor-outer">
              Service is for <span class="service-availer">{{waitlist_for.name}}</span> <span (click)="handleServiceForWhom()">Change?</span>
          </div>
          
          <ng-container *ngIf="step==2">
          <div class="revealdiv">
                <div class="form-group">
                    <mat-checkbox [checked]="revealphonenumber" (change)="revealChk()">Reveal your phone number to this provider?</mat-checkbox>
                </div>
          </div>
          <div class="consumer-comment">
                <div class="form-group">
                    <label for="reason" class="col-form-label">Leave a Note</label>
                    <textarea matInput #consumernote (change)="handleConsumerNote(consumernote.value)"></textarea>
                </div>
          </div>
          </ng-container>
      </div>
  </mat-dialog-content>
  <mat-dialog-actions>
  <button mat-button class="cs-btn bt1" *ngIf="isCheckinenable()" (click)="handleCheckinClicked()">{{showCheckinButtonCaption()}}</button>
  <div class="disable-msg" *ngIf="!isCheckinenable() && checkindisablemsg !=''">{{checkindisablemsg}}</div>
  <button type="button" mat-button class="cs-btn bt2" *ngIf="step==2" (click)="handleGoBack(1)">G0 Back</button>
  <button  type="button" mat-dialog-close class="cs-btn bt2">Cancel</button>
  </mat-dialog-actions>

  <app-field-error-display [displayError]="true" *ngIf="api_error" errorMsg="{{api_error}}"></app-field-error-display>
  <app-form-success-display [displayMsg]="true" *ngIf="api_success" successMsg="{{api_success}}"></app-form-success-display>
