<section class="container consumer-dashhome no-padding no-padding-small">
    <div class="panel panel-default">
        <div class="panel-heading top-row ">
            <app-header [headerTitle]=""></app-header>
            <!-- <div class="mgn-up-20">
                <app-search-form></app-search-form>
            </div> -->
        </div>
        <div class="panel-body no-padding">
            <div class="content consumer-dash mgn-bt-10" *ngIf="api_loading">
                <app-common-innerloading-spinner>
                </app-common-innerloading-spinner>
            </div>
            <div class="content consumer-dash" *ngIf="!api_loading">
                <div class="card c-checkins">
                    <h1 class="ng-tns-c16-8">
                        <span class="ng-tns-c16-8">
                            Hello {{usr_details.userName}} !
                        </span> <br>
                        <button class="mgn-up-20 find-sp-btn" mat-raised-button>Find Service Provider</button>
                    </h1>
                    <h2 class="ng-tns-c16-8">
                        <div class="col-sm-12 col-md-12 col-lg-12 col-xs-12">
                            <div class="col-sm-4 col-md-6 col-lg-6 col-xs-4 mgn-up-10">MY BOOKINGS</div>
                            <div class="col-sm-8 col-md-6 col-lg-6 col-xs-8">
                                <div class="col-sm-4 col-md-4 col-lg-4 col-xs-4">
                                    <button class="flat-btn" mat-raised-button>My Favourites</button>
                                </div>
                                <div class="col-sm-4 col-md-4 col-lg-4 col-xs-4">
                                    <button class="flat-btn" mat-raised-button>Past History</button>
                                </div>
                                <div class="col-sm-4 col-md-4 col-lg-4 col-xs-4">
                                    <button (click)="paymentsClicked()" class="flat-btn" mat-raised-button>My
                                        Payments</button>
                                </div>
                            </div>
                        </div>
                    </h2>
                    <div *ngIf="(appointments.length == 0 && (loadcomplete.waitlist && waitlists && waitlists.length == 0) && (loadcomplete.donations && donations && donations.length == 0))"
                        class="col-md-12 col-xs-12 col-sm-12 mgn-up-20 nocheckins">
                        <p class="locate-customer">No current Bookings available</p>
                    </div>
                    <div class="table-outer ng-tns-c16-57">
                        <table class="table">
                            <!-- Today Appointments -->
                            <tbody *ngIf="appointments.length != 0">
                                <tr *ngFor="let appointment of appointments; let i=index">
                                    <td><h4>{{appointment.appmtTime}}</h4>
                                        <span>TODAY</span>
                                    </td>
                                    <td class="tdisplay-block">
                                        <h4>{{appointment.providerAccount.businessName || '' | capitalizeFirst}}</h4>
                                        <span>
                                            <i class="fa phon-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'Phone'"></i>
                                            <i class="fa meet-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'GoogleMeet'"></i>
                                            <i class="fa zoom-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'Zoom'"></i>
                                            <i class="fa wtsapaud-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'WhatsApp' && appointment.service.virtualServiceType ==='audioService'"></i>
                                            <i class="fa wtsapvid-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'WhatsApp' && appointment.service.virtualServiceType ==='videoService'"></i>
                                        </span>
                                        {{appointment.service.name | capitalizeFirst}}</td>
                                    <td>
                                        <h6>{{appointment.apptStatus}}</h6>
                                    </td>
                                    <td>
                                        <span
                                            *ngIf="appointment.amountDue>0 && (appointment.billViewStatus=='Show') && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'">

                                            <button class="flat-btn" mat-raised-button
                                                (click)="viewBill(appointment,'appointment')">Pay
                                                &#8377;{{appointment.amountDue}}</button>
                                        </span>
                                    </td>
                                    <td>
                                        <span *ngIf="appointment.billViewStatus == 'Show'">
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="!(appointment.amountDue>0) && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'"
                                                (click)="viewBill(appointment,'appointment')">View Receipt</button>
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="(appointment.apptStatus === 'Cancelled' || appointment.apptStatus === 'Rejected') && appointment.paymentStatus !== 'NotPaid'"
                                                (click)="viewBill(appointment,'appointment')">View Receipt</button>
                                            <button mat-raised-button class="flat-btn"
                                                *ngIf="appointment.amountDue>0 && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'"
                                                (click)="viewBill(appointment,'appointment')">View Bill</button>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>

                            <!-- Today Waitlists -->
                            <tbody *ngIf="loadcomplete.waitlist && waitlists && waitlists.length != 0">
                                <tr *ngFor="let waitlist of waitlists; let i=index">
                                    <td>
                                        <h4>{{waitlist.checkInTime}}</h4>
                                        <span>TODAY</span>
                                    </td>
                                    <td class="tdisplay-block">
                                        <h4>{{waitlist.providerAccount.businessName || '' | capitalizeFirst}}</h4>
                                        <span>
                                            <i class="fa phon-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0 && waitlist.service.virtualCallingModes[0].callingMode === 'Phone'"></i>
                                            <i class="fa meet-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'GoogleMeet'"></i>
                                            <i class="fa zoom-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'Zoom'"></i>
                                            <i class="fa wtsapaud-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'WhatsApp' && waitlist.service.virtualServiceType ==='audioService'"></i>
                                            <i class="fa wtsapvid-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'WhatsApp' && waitlist.service.virtualServiceType ==='videoService'"></i>
                                        </span>
                                        {{waitlist.service.name | capitalizeFirst}}</td>
                                    <td>
                                        <h6>{{waitlist.waitlistStatus | capitalizeFirst}}</h6>
                                        </td>
                                    <td>
                                        <span
                                            *ngIf="waitlist.amountDue>0 && (waitlist.billViewStatus=='Show') && waitlist.waitlistStatus != 'cancelled'">
                                            <button class="flat-btn" (click)="viewBill(waitlist,'checkin')"
                                                mat-raised-button>Pay &#8377;{{waitlist.amountDue}}</button>
                                        </span>
                                    </td>
                                    <td>
                                        <span *ngIf="waitlist.billViewStatus == 'Show'">
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="!(waitlist.amountDue>0) && waitlist.waitlistStatus != 'cancelled'"
                                                (click)="viewBill(waitlist,'checkin')">View Receipt</button>
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="waitlist.waitlistStatus === 'cancelled' && waitlist.paymentStatus !== 'NotPaid'"
                                                (click)="viewBill(waitlist,'checkin')">View Receipt</button>
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="waitlist.amountDue>0 && waitlist.waitlistStatus != 'cancelled'"
                                                (click)="viewBill(waitlist,'checkin')">View Bill</button>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>

                             <!-- Future Appointments -->
                             <tbody *ngIf="future_appointments.length != 0">
                                <tr *ngFor="let appointment of future_appointments; let i=index">
                                    <td><h4>{{appointment.appmtTime}}</h4>
                                        <span>UPCOMING</span>
                                    </td>
                                    <td class="tdisplay-block">
                                        <h4>{{appointment.providerAccount.businessName || '' | capitalizeFirst}}</h4>
                                        <span>
                                            <i class="fa phon-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'Phone'"></i>
                                            <i class="fa meet-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'GoogleMeet'"></i>
                                            <i class="fa zoom-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'Zoom'"></i>
                                            <i class="fa wtsapaud-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'WhatsApp' && appointment.service.virtualServiceType ==='audioService'"></i>
                                            <i class="fa wtsapvid-icon"
                                                *ngIf="appointment.service.serviceType === 'virtualService' && appointment.service.virtualCallingModes.length > 0  && appointment.service.virtualCallingModes[0].callingMode === 'WhatsApp' && appointment.service.virtualServiceType ==='videoService'"></i>
                                        </span>
                                        {{appointment.service.name | capitalizeFirst}}</td>
                                    <td>
                                        <h6>{{appointment.apptStatus}}</h6>
                                    </td>
                                    <td>
                                        <span
                                            *ngIf="appointment.amountDue>0 && (appointment.billViewStatus=='Show') && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'">

                                            <button class="flat-btn" mat-raised-button
                                                (click)="viewBill(appointment,'appointment')">Pay
                                                &#8377;{{appointment.amountDue}}</button>
                                        </span>
                                    </td>
                                    <td>
                                        <span *ngIf="appointment.billViewStatus == 'Show'">
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="!(appointment.amountDue>0) && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'"
                                                (click)="viewBill(appointment,'appointment')">View Receipt</button>
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="(appointment.apptStatus === 'Cancelled' || appointment.apptStatus === 'Rejected') && appointment.paymentStatus !== 'NotPaid'"
                                                (click)="viewBill(appointment,'appointment')">View Receipt</button>
                                            <button mat-raised-button class="flat-btn"
                                                *ngIf="appointment.amountDue>0 && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'"
                                                (click)="viewBill(appointment,'appointment')">View Bill</button>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>

                            <!-- Future Waitlists -->
                            <tbody *ngIf="future_waitlists && future_waitlists.length != 0">
                                <tr *ngFor="let waitlist of future_waitlists; let i=index">
                                    <td>
                                        <h4>{{waitlist.checkInTime}}</h4>
                                        <span>UPCOMING</span>
                                    </td>
                                    <td class="tdisplay-block">
                                        <h4>{{waitlist.providerAccount.businessName || '' | capitalizeFirst}}</h4>
                                        <span>
                                            <i class="fa phon-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0 && waitlist.service.virtualCallingModes[0].callingMode === 'Phone'"></i>
                                            <i class="fa meet-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'GoogleMeet'"></i>
                                            <i class="fa zoom-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'Zoom'"></i>
                                            <i class="fa wtsapaud-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'WhatsApp' && waitlist.service.virtualServiceType ==='audioService'"></i>
                                            <i class="fa wtsapvid-icon"
                                                *ngIf="waitlist.service.serviceType === 'virtualService' && waitlist.service.virtualCallingModes.length > 0  && waitlist.service.virtualCallingModes[0].callingMode === 'WhatsApp' && waitlist.service.virtualServiceType ==='videoService'"></i>
                                        </span>
                                        {{waitlist.service.name | capitalizeFirst}}</td>
                                    <td>
                                        <h6>{{waitlist.waitlistStatus | capitalizeFirst}}</h6>
                                        </td>
                                    <td>
                                        <span
                                            *ngIf="waitlist.amountDue>0 && (waitlist.billViewStatus=='Show') && waitlist.waitlistStatus != 'cancelled'">
                                            <button class="flat-btn" (click)="viewBill(waitlist,'checkin')"
                                                mat-raised-button>Pay &#8377;{{waitlist.amountDue}}</button>
                                        </span>
                                    </td>
                                    <td>
                                        <span *ngIf="waitlist.billViewStatus == 'Show'">
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="!(waitlist.amountDue>0) && waitlist.waitlistStatus != 'cancelled'"
                                                (click)="viewBill(waitlist,'checkin')">View Receipt</button>
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="waitlist.waitlistStatus === 'cancelled' && waitlist.paymentStatus !== 'NotPaid'"
                                                (click)="viewBill(waitlist,'checkin')">View Receipt</button>
                                            <button mat-flat-button class="flat-btn"
                                                *ngIf="waitlist.amountDue>0 && waitlist.waitlistStatus != 'cancelled'"
                                                (click)="viewBill(waitlist,'checkin')">View Bill</button>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>


                            <!-- Donation section -->
                            <tbody *ngIf="loadcomplete.donations && donations && donations.length != 0">
                                <tr *ngFor="let donation of donations; let i=index">
                                    <td>{{donation.date}}</td>
                                    <td class="tdisplay-block">
                                        {{donation.providerAccount.businessName || '' | capitalizeFirst}}<br>
                                        {{donation.service.name | capitalizeFirst}}
                                    </td>
                                    <td>{{donation.donationStatus | capitalizeFirst}}</td>
                                    <td>{{donation.donationAmount}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div [innerHTML]="payment_popup" #div [style.display]="'none'"></div>